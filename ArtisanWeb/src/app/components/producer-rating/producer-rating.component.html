<!-- src/app/components/producer-rating/producer-rating.component.html -->

<div class="producer-rating">
  <!-- Загрузка -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Загрузка рейтинга...</p>
  </div>

  <!-- Ошибка -->
  <div *ngIf="error && !loading" class="error">
    <p>{{ error }}</p>
  </div>

  <!-- Рейтинг -->
  <div *ngIf="ratingStats && !loading && !error" class="rating-container">
    <!-- Основной рейтинг -->
    <div class="main-rating">
      <div class="average-rating">
        <span class="rating-number">{{ ratingStats.averageRating.toFixed(1) }}</span>
        <app-star-rating 
          [rating]="ratingStats.averageRating" 
          [readonly]="true"
          size="large">
        </app-star-rating>
      </div>
      <p class="total-ratings">{{ ratingStats.totalRatings }} {{ getRatingWord() }}</p>
    </div>

    <!-- Детальная статистика -->
    <div *ngIf="showDetails && ratingStats.totalRatings > 0" class="rating-details">
      <div *ngFor="let star of [5, 4, 3, 2, 1]" class="rating-row">
        <span class="star-label">{{ star }}</span>
        <svg class="star-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
        </svg>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="getStarPercentage(star)"></div>
        </div>
        <span class="star-count">{{ getStarCount(star) }}</span>
      </div>
    </div>

    <!-- Сообщение, если нет оценок -->
    <div *ngIf="ratingStats.totalRatings === 0" class="no-ratings">
      <p>Пока нет оценок</p>
    </div>
  </div>
</div>
